#! /usr/bin/env node
var fs = require('fs');
var path = require('path');
var util = require('util');
var CHARSET = 'utf8';

function realpath(arg) {
    if (/^\//.test(arg)) {
        return arg;
    } else {
        return path.join(process.cwd(), arg);
    }
}

function main(argv) {
    var input  = realpath(argv._[0]);
    var result = parse(input);
    process.stdout.write(util.inspect(result, false, null) + '\n');
}

function parse(input) {
    var Tea = require('../lib/tea');
    return Tea.ast(fs.readFileSync(input, CHARSET));
}

main(require('optimist').
    usage('Usage: $0 <fname>').
    demand(1).
    argv);

