#! /usr/bin/env node
var fs = require('fs');
var path = require('path');
//var util = require('util');
var CHARSET = 'utf8';

function realpath(arg) {
    if (/^\//.test(arg)) {
        return arg;
    } else {
        return path.join(process.cwd(), arg);
    }
}

function lex(input) {
    var lexer = require('../lib/lexer');
    lexer.setInput(fs.readFileSync(input, CHARSET));
    return lexer.tokens.map(function (token) {
        return token.inspect();
    }).join(" ");
}

function main(argv) {
    var input  = realpath(argv._[0]);
    var result = lex(input);
    process.stdout.write(result + '\n');
}

main(require('optimist').
    usage('Usage: $0 <fname>').
    demand(1).
    argv);

