#! /usr/bin/env node
var fs = require('fs');
var path = require('path');
var util = require('util');
var CHARSET = 'utf8';

function main(argv) {
    var input  = path.join(process.cwd(), argv._[0]);
    var result = lex(input);
    process.stdout.write(util.inspect(result, false, null));
}

function lex(input) {
    var lexer = require('../lib/parser').lexer;
    lexer.setInput(fs.readFileSync(input, CHARSET));

    var tokens = [], token;
    while ((token = lexer.lex()) !== lexer.EOF) {
        //tokens.push([ parser.terminals_[token], lexer.yytext ]);
        if (typeof token === 'number') {
            tokens.push(lexer.yytext);
        } else {
            tokens.push(token);
        }
    }
    return tokens;
}

main(require('optimist').
    usage('Usage: $0 <fname>').
    demand(1).
    argv);

