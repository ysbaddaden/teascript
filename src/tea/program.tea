scopes = require('./scopes')

def Program
  def init(body)
    self.body = body
    return self
  end

  def compile(options = {})
    body = scopes.run(-> {
      return self.body.compile(scope: true)
    })
    return '(function () {' + body + '}());' if options.scoped
    return 'function (require, module, exports) {' + body + '});' if options.amd
    return body
  end
end

module.exports = Program
